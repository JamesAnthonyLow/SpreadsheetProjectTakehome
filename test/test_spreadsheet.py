import typing

import pytest

import spreadsheet


@pytest.mark.parametrize(
    "changes,expected",
    [
        (
            [],
            """+-----+---+---+---+---+---+---+---+---+---+---+
| Row | A | B | C | D | E | F | G | H | I | J |
+-----+---+---+---+---+---+---+---+---+---+---+
|  1  |   |   |   |   |   |   |   |   |   |   |
|  2  |   |   |   |   |   |   |   |   |   |   |
|  3  |   |   |   |   |   |   |   |   |   |   |
|  4  |   |   |   |   |   |   |   |   |   |   |
|  5  |   |   |   |   |   |   |   |   |   |   |
|  6  |   |   |   |   |   |   |   |   |   |   |
|  7  |   |   |   |   |   |   |   |   |   |   |
|  8  |   |   |   |   |   |   |   |   |   |   |
|  9  |   |   |   |   |   |   |   |   |   |   |
|  10 |   |   |   |   |   |   |   |   |   |   |
+-----+---+---+---+---+---+---+---+---+---+---+""",
        ),
        (
            [("B2", "2")],
            """+-----+---+---+---+---+---+---+---+---+---+---+
| Row | A | B | C | D | E | F | G | H | I | J |
+-----+---+---+---+---+---+---+---+---+---+---+
|  1  |   |   |   |   |   |   |   |   |   |   |
|  2  |   | 2 |   |   |   |   |   |   |   |   |
|  3  |   |   |   |   |   |   |   |   |   |   |
|  4  |   |   |   |   |   |   |   |   |   |   |
|  5  |   |   |   |   |   |   |   |   |   |   |
|  6  |   |   |   |   |   |   |   |   |   |   |
|  7  |   |   |   |   |   |   |   |   |   |   |
|  8  |   |   |   |   |   |   |   |   |   |   |
|  9  |   |   |   |   |   |   |   |   |   |   |
|  10 |   |   |   |   |   |   |   |   |   |   |
+-----+---+---+---+---+---+---+---+---+---+---+""",
        ),
        (
            [("B2", "=sum([3, 4])"), ("I9", "=5*2")],
            """+-----+---+---+---+---+---+---+---+---+----+---+
| Row | A | B | C | D | E | F | G | H | I  | J |
+-----+---+---+---+---+---+---+---+---+----+---+
|  1  |   |   |   |   |   |   |   |   |    |   |
|  2  |   | 7 |   |   |   |   |   |   |    |   |
|  3  |   |   |   |   |   |   |   |   |    |   |
|  4  |   |   |   |   |   |   |   |   |    |   |
|  5  |   |   |   |   |   |   |   |   |    |   |
|  6  |   |   |   |   |   |   |   |   |    |   |
|  7  |   |   |   |   |   |   |   |   |    |   |
|  8  |   |   |   |   |   |   |   |   |    |   |
|  9  |   |   |   |   |   |   |   |   | 10 |   |
|  10 |   |   |   |   |   |   |   |   |    |   |
+-----+---+---+---+---+---+---+---+---+----+---+""",
        ),
    ],
)
def test_pretty_print(
    changes: typing.List[typing.Tuple[str, str]], expected: str
) -> None:
    sheet = spreadsheet.Spreadsheet()
    for cell_key, value in changes:
        sheet[cell_key] = value
    assert f"{sheet}" == expected
